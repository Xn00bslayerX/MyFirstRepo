<!DOCTYPE HTML>
<html>
<head>
  <title>Products</title>
  <link rel="stylesheet" href="styles.css" type="text/css">
  <style>
    img {
      max-height: 33vh;
    }
  </style>
</head>
<body>
   <h1>Products Catalog</h1>
  <div id="navbar"></div>
  <script>
    fetch('navbar.html')
      .then(response => response.text())
      .then(data => {
        document.getElementById('navbar').innerHTML = data;
      });
  </script>
  <div class="card-container">
    <div>
      <input type="text" id="searchInput" placeholder="Search by name">
      <button onclick="searchProducts()">Search</button>
    </div>
    <table id="productTable">
      <thead>
        <th>Image</th>
        <th>Name</th>
        <th>Category</th>
        <th>Description</th>
        <th>Price</th>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
  <script>
    const server = "https://makeup-api.herokuapp.com/api/v1/products.json";
    let productsData = []; // Store all products data

    async function getAndLoadAPIdata() {
      let response = await fetch(server);
      let data = await response.json();
      console.log(data, "fetched from", server);
      productsData = data; // Store all products data in the variable
      loadProductsTable(data);
    }

    function loadProductsTable(data) {
      const productTableBody = document.querySelector('#productTable tbody');
      productTableBody.innerHTML = '';

      data.forEach(element => {
        let row = document.createElement('tr');
        row.innerHTML = `
          <td><img src="${element.image_link}" alt="Product Image"></td>
          <td><a href="${element.product_link}">${element.name}</a></td>
          <td>${element.category}</td>
          <td>${element.description}</td>
          <td>${element.price_sign}${element.price} ${element.currency}</td>
        `;

        productTableBody.appendChild(row);
      });
    }

    function searchProducts() {
      const searchInput = document.getElementById('searchInput');
      const searchTerm = searchInput.value.toLowerCase();
      const filteredData = productsData.filter(product => product.name.toLowerCase().includes(searchTerm));
      loadProductsTable(filteredData);
    }

    // Call the function to fetch and load the API data
    getAndLoadAPIdata();
  </script>
</body>
</html>
